## 量化交易 ##
由于多数期货交易技术分析有相似之处，目前市场上存在大量使用相似进场点和止损点作为交易指标的量化交易系统。  

冯正平认为，量化交易只是工具，如果迷信量化的历史测试结果，被动等待历史重演，那么将看不到**市场博弈的本质**，结果就必然导致交易程序高度相似。  

“你的交易对手是人，而不是K线图。当你在认真的研究K线图的时候，你的对手在研究你。”  

他表示，市场的任何量化特征都会改变，**唯独博弈本质不会改变**。不能从博弈的视角来审视量化研究，就是在玩数字游戏。目前很多量化研究都是在玩数字游戏，因为他们脱离了市场的本质。  

“很明显，市场上量化交易者的增加，让不同量化交易者之间的竞争更加激烈。”刘先生认为，最初量化交易者的对手是一些主观交易者，量化交易用数据统计和计算机的一致性获得了胜利，但在现阶段，不同量化交易者之间开始通过相互之间的角力，从对方手中争夺利润。  

“要避免被‘反量化’者捕杀，就要建立不同的策略组合，实现不同策略之间的低相关性、异构性与丰富性。”冯正平认为，未来量化交易者要建立行情分析系统，最好要有多种算法分析平台，而不以K线图为唯一分析对象。  

刘先生也认为，未来期货公司资管部门的交易策略将以收益较为稳定的量化交易为主，各个机构**量化模型**之间的比拼将更加激烈。只有充分研究**市场形态**与变化特征，开发出具有不同收益特征的策略组合，才能在竞争中占据一席之地。

## 数据可视化 ##   

- matlab montage  
- 平行坐标  
  
## 收益与胜率、赔率的关系 ## 

胜率 \\(\alpha\\)：  
赔率 \\(\beta\\)：

----------
<div style="float:right;border:solid 5px;margin:1px;">
<img src="https://i.imgur.com/JSgZR1k.jpg"  width="300" height="" >
</div>  
  
由图中的公式可见  

  
- 胜率 × ( 1 + 赔率 ) > 1  : 收益为正  

----------  
重要

## 模型与参数 ##
模型可以理解为交易策略在数学上的术语，也可以称为**策略模型**。
模型选择与参数调优哪个更重要？
模型正确时，对参数的敏感度就会低么？


## 指标的特征是具有 `滞后性` ## 
  
## 形态观察，形态特点 ##
根据不同的形态，采用不同的策略。

<div align=right>
<img src="https://i.imgur.com/6MqfB9m.png" width = "500" height = ""/>
</div>


## 多品种组合 ##
单品种有回撤期，多品种组合就比较重要，可以优化总的资金曲线。

## 公式  <!--Preview in Brower 可正确显示公式--> ##


这是行间公式
$$x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}$$
 
这是行内公式\\(E = mc^2\\)这里是行内公式

 
## 理想的单边行情 ##
在理想的单边行情下，nPeriodBreak越小越好,**当取1时就等于不止损**。
如果单边行情结束，也会始终不止损。

## 设置TB参数的默认优化范围  ##

----------

<div style="float:right;border:solid 1px;margin:1px;">
<img src="https://i.imgur.com/UvvckG6.png" width = "400" height = ""/>
</div>

属性设置

----------

## 道琼斯指数 ##
道琼斯指数最早是在1884年由道琼斯公司的创始人查尔斯·亨利·道（Charles Henry Dow 1851-1902年）开始编制的一种算术**平均股价**指数。道琼斯指数是世界上历史最为悠久的股票指数，它的全称为**股票价格平均指数**。

## 对数化 ##
将指数增长变为线性增长。

迭代式
$$ x = (1+0.3)x $$   
等价于  
$$ y = x_0\cdot1.3^{n} $$  

其对数化后的形式为   
$$ \log\left(x_0\right)+n\cdot\log\left(1.3\right) $$   

变为一条直线，该直线的斜率为 \\(\log_{a}\left(1.3\right)\\)。


## 风险控制 ##
如果亏损50%，则需要盈利100%才能恢复。
如果亏损80%，则需要盈利400%才能恢复。

## 在线作图 ##
Lucidchart
https://www.lucidchart.com

## 止损宽度与胜率 ##

<div style="float:right;margin:1px;">
<img src="https://i.imgur.com/pYSZTlA.png " width = "800" height = ""/>
</div>


----------


## 止损宽度与赔率 ##

<div style="float:right;margin:1px;">
<img src="https://i.imgur.com/DL6DWso.png " width = "400" height = ""/>
</div>

止损变宽时，赔率的分子部分不一定变大。要看趋势能走多远，还要看次级波动的深度。

----------

## 参数的优化方法 ##
以下方法是否可行？
1. 随机入场，优化出场参数。
2. 按照优化好的出场参数，再优化入场参数。

## 根据模型找市场 VS 根据市场找模型 ##
是根据自己已有的策略模型去找市场呢？
还是  
根据市场的形态，想办法寻找策略模型。

## 入场条件和出场条件冲突时的选择 ##
当满足入场条件时，还未达到出场条件怎么办？
1. 等到出场条件满足时，再看入场条件。
2. 入场条件满足时，立即出场并反向入场。
3. 各管各的。比如，场内是多单时仍然持仓，并入场开空单。

## markdown toc ##
生成侧边栏目录  
toc: Table of Contents  
https://github.com/i5ting/tocmd.npm  

运行本笔记文件夹下面的批处理文件 tocmd.bat 
可以生成具有侧边栏目录的html文件。

## 波动的作用 ##

<div style="float:right;margin:1px;">
<img src="https://i.imgur.com/D7r1GLN.png " width = "400" height = ""/>
</div>

如果在每一个波动的拐点上都开对方向，在两条线上的收益相同。
只有


1. 止盈加反趋势
2. 或者反趋势加开仓优先

才能达到这种效果。

----------

## TB 批量导入/导出数据 ##

格式为*.dat  
但不知道具体格式，没法读取与编辑。

论坛上管理员回答都是暂时不提供该数据读取服务  
http://bbs.tb18.net/thread-110691-1-1.html  
http://bbs.tb18.net/thread-18086-1-1.html  
http://bbs.tb18.net/thread-19629-1-1.html  

## TB数据格式为7列 ##
<div style="float:right;margin:1px;">
<img src="https://i.imgur.com/i5kcaVt.png " width = "400" height = ""/>
</div>


1. TB数据格式为7列
2. 它决定了批量导出的DAT文件格式
3. date double double double double int32 int32
4. date 占12个字节
5. 每个合约第一条记录date的前4个字节int32格式放置该合约的记录数。
6. 每条记录为56个字节。
7. 第一个int32占8个字节，其本身占4个字节，补4个字节的0。
8. 最末int32占4个字节。
9. 整个文件的末尾要添加4个字节。
10. ...\future\数据维护\TB批量导入导出\GenerateImportFile.m

----------

<div style="float:right;margin:1px;">
<img src="https://i.imgur.com/314kcGN.png " width = "400" height = ""/>
</div>

导入数据只会覆盖相同日期的数据，原有的其他日期的数据被保留，不会被删除。要想完全清空数据，只能删除商品，然后重新自定义商品，再进行数据导入。

----------

## 确定窗口和按钮的位置 ##
1. 打开Spy++
2. Ctrl+F,打开查找窗口
3. 拖动射击靶图标到窗口或者按钮上
![](https://i.imgur.com/C3LVSd7.png)


## 设置进程的优先级 ##
在MATLAB一段时间不使用后，再次使用时似乎需要一点时间才能进行流畅状态。可能是在其空闲一段时间后，原先占用的资源被系统收回，分配给其他进程使用。

优先级设置时提示拒绝访问，怎么办？
给一个进程设置优先级时，提示说拒绝访问，怎么办？
用管理员模式打开任务管理器。就是你先搜索taskmgr然后再用右键 以管理员身份运行。

## 期货合约最小变动 ##


**最小变动价位**：是指在期货交易所的公开竞价过程中，对合约标的每单位价格报价的最小变动数值。最小变动价位乘以交易单位，就是该合约价格的**最小变动值**。例如，大连商品交易所豆粕期货合约的最小变动价位是1元/吨，即每手合约的**最小变动值**是1元/吨×10吨=10元。  
在期货交易中，每次报价必须是其合约规定的最小变动价位的整数倍。期货合约最小变动价位的确定，通常取决于该合约标的商品的种类、性质、市场价格波动情况和商业规范等。

**报价精度**：最小变动价位的精度。比如黄金的报价最小变动价位为0.05元，报价精度为0.01元，表示精确到小数点后面两位。黄金合约价格的最小变动值为5元。

## MATLAB try ... catch ##
```
try
    outfilename = websave(fileName,url);

catch ErrorInfo % 捕获到的错误是一个MException对象
    disp(ErrorInfo);
    % 发生错误时的其他动作
end
```

## 精易编程助手 ##
它是一个**免安装**软件。功能类似于与 **Microsoft Spy++**
它的功能包括
1. 窗口探测
2. 屏幕取色

## TB 自动操作 ##

自定义商品  
可以用**程序实现**    
...\图像识别\TBcreateContractMain.m  
  
自动批量导入，自动打开工作室。  
C:\D\xyz\future\m\跟踪开仓-记录资金-图像识别-4\图像识别\TBHandle.m  
C:\D\xyz\future\m\跟踪开仓-记录资金-图像识别-4\图像识别\TBHandle1.m  

输入父窗口的句柄和子窗口的标题，来得到子窗口的句柄。  
查找子窗口必须逐层查找，每次只能查找位于下一层的子窗口  
按钮也是一个子窗口，可以通过其父窗口的句柄和按钮标题查找  
C:\D\xyz\future\m\跟踪开仓-记录资金-图像识别-4\图像识别\findChildWin.c  

通过按钮句柄，点击按钮。按钮窗体需要位于屏幕前台。  
C:\D\xyz\future\m\跟踪开仓-记录资金-图像识别-4\图像识别\ClickButton.c  

## matlab 调用外部bat文件 ##
matlab的m文件中调用外部bat文件，并确定bat运行结束以后，再接着运行剩下的代码，这样的m语句怎么写？ 

直接用dos函数执行就可以了。

举例说，如果批处理文件名 test_bat.bat，则
```
[s,e]=dos('test_bat');
```
就会执行批处理文件，**直到其结束才返回**。这里之所以让dos返回两个参数，是为了避免标准输出信息在命令窗口中回显。 

**如果不希望等待执行完毕才返回**，可以在命令后加一个“&”，例如：
```
[s,e]=dos('test_bat &');
```
会打开一个cmd窗口去执行批处理，不需要等待批处理执行完毕就会直接返回，接下来继续执行M文件的后续部分。

## TB工作区的打开顺序 ##
TB工作室的各个工作区打开有固定顺序。可以在第一个打开的工作区加载公式，执行一些预处理工作，比如文件清理等。

## TB中画竖直线 ##
<div style="float:right;margin:1px;">
<img src="https://i.imgur.com/gat4VmK.png " width = "400" height = ""/>
</div>

PlotNumeric ("OpenToClose",Open,Close);  
PlotNumeric ("OpenToClose",Open*0.5,Close*1.5);  
输出开盘价与收盘价的连线。（需要在公式属性的输出线形选择柱状图）


----------

## MATLAB 的 unique 与 table ##
去除重复的行  
列的数据类型不同  
这时需要使用 table 函数。  
```
x = {'a','b','c','a'}';
y = [1 2 3 1; 1 2 3 1]';
t = table(x,y);
[C,IA,IC] = unique(t);
```
t = 

     x       y   
    ___    ______

    'a'    1    1
    'b'    2    2
    'c'    3    3
    'a'    1    1

C = 

     x       y   
    ___    ______

    'a'    1    1
    'b'    2    2
    'c'    3    3


```
x = {'a',1;'b',2;'a',1};  
t  =cell2table(x);  
ut = unique(t);  
```
ut = 

    x1     x2
    ___    __

    'a'    1 
    'b'    2 




</br></br></br></br></br></br></br></br>
</br></br></br></br></br></br></br></br>
</br></br></br></br></br></br></br></br>
 
 
 













